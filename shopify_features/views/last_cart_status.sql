create or replace view RUDDERSTACK_TEST_DB.DATA_APPS_SIMULATED_SHOPIFY.LAST_CART_STATUS(
	BRAND,
	DISCOUNTED_PRICE,
	GIFT_CARD,
	GRAMS,
	ID,
	KEY,
	LINE_PRICE,
	ORIGINAL_LINE_PRICE,
	ORIGINAL_PRICE,
	PRICE,
	PRODUCT_ID,
	PROPERTIES,
	QUANTITY,
	SKU,
	TAXABLE,
	TITLE,
	TOTAL_DISCOUNT,
	_VARIANT_,
	PRODUCTS,
	ANONYMOUS_ID,
	TIMESTAMP,
	TOKEN,
	ORDER_CREATED_ANONYMOUS_ID,
	USER_ID,
	TOTAL_PRICE_USD,
	ORDER_CREATED_PRODUCTS,
	PAYMENT_DETAILS_CREDIT_CARD_COMPANY,
	ORDER_NUMBER,
	ORDER_CREATED_TIMESTAMP,
	CART_TOKEN,
	FULFILLMENT_STATUS,
	FINANCIAL_STATUS
) as 
with cte as 
(select cli.BRAND,
cli.DISCOUNTED_PRICE,
cli.GIFT_CARD,
cli.GRAMS,
 cli.ID,
 cli.KEY,
 cli.LINE_PRICE,
 cli.ORIGINAL_LINE_PRICE,
 cli.ORIGINAL_PRICE,
 cli.PRICE,
 cli.PRODUCT_ID,
 cli.PROPERTIES
,cli.QUANTITY,
 cli.SKU,
 cli.TAXABLE,
 cli.TITLE,
 cli.TOTAL_DISCOUNT,
 cli._VARIANT_,
 cli.PRODUCTS,
 cli.ANONYMOUS_ID,
 cli.TIMESTAMP,
 cli.TOKEN,
 oc.ANONYMOUS_ID as Order_Created_Anonymous_ID,
 oc.USER_ID,oc.TOTAL_PRICE_USD,
 oc.PRODUCTS as order_created_products,
 oc.PAYMENT_DETAILS_CREDIT_CARD_COMPANY,
 oc.ORDER_NUMBER,
 oc.TIMESTAMP as order_created_timestamp,
 oc.CART_TOKEN,oc.FULFILLMENT_STATUS,
 oc.FINANCIAL_STATUS 
 from cart_line_items cli left outer join order_created oc on cli.token=oc.cart_token )
 Select * from cte;